import{d as Y,r as q,C,c as M,o as g,a as s,u as e,m as Z,w as t,b as n,e as o,f as E,g as D,h as Q,F as B,i as h,t as V,j as ee}from"./app-SbPqFmdB.js";import{_ as le,K as m}from"./AppLayout.vue_vue_type_script_setup_true_lang-BRmenTdq.js";import{_ as k,a as se,b as U,c as N,d as S,e as F,f as P}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-BSVIH4n0.js";import{_ as te,a as ae,b,c as y,d as ne,e as u}from"./TableHeader.vue_vue_type_script_setup_true_lang-B5TaU_aA.js";import{_ as f}from"./index-DcrgW_Wg.js";import{_ as p,a as c}from"./Label.vue_vue_type_script_setup_true_lang-B8UtQLSx.js";import{u as oe,a as re}from"./useQuery-D1i4emc1.js";import{L as de}from"./loader-circle-BLBjTk-t.js";import{C as ie}from"./circle-minus--w7iLidS.js";import{P as ue,T as me}from"./trash-2-G7x92z5O.js";import"./NavFooter.vue_vue_type_script_setup_true_lang-hsCj40vg.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C-TdNUzX.js";const fe={class:"p-6 space-y-6"},pe={class:"flex w-full justify-between items-center"},ce={class:"grid gap-4 py-4"},_e={class:"grid grid-cols-4 items-center gap-4"},ge={class:"grid grid-cols-4 items-center gap-4"},ye={class:"grid grid-cols-4 items-center gap-4"},ve={class:"grid gap-4 py-4"},xe={class:"grid grid-cols-4 items-center gap-4"},we={class:"grid grid-cols-4 items-center gap-4"},Ae={class:"grid grid-cols-4 items-center gap-4"},Ve={class:"text-center text-green-500 flex items-center justify-center"},be={class:"text-center text-red-500 flex items-center justify-center"},Be=Y({__name:"Admin-Management",setup($e){const $=oe(),L=[{title:"Admin Management",href:"/admin/admin-management"}],T=async()=>(await ee.post("/graphql",{query:`
    query {
      admins {
        encrypted_id
        name
        email
        role
      }
    }
  `})).data.data,{isPending:J,error:qe,data:j,isFetching:Ce}=re({queryKey:["fetchAdmins"],queryFn:T}),v=q(!1);function R(){v.value=!0}const d=C({name:"",email:"",password:""}),z=()=>{d.post(route("create.admin"),{onSuccess:()=>{m.success("Admin account created successfully"),d.reset(),v.value=!1,$.invalidateQueries({queryKey:["fetchAdmins"]})},onError:()=>{m.error("Email already exists"),console.error("Error")}})},x=q(!1);function G(_,l,a){r.id=_,r.name=l,r.email=a,x.value=!0}const r=C({id:"",name:"",email:"",password:""}),H=()=>{r.patch(route("update.admin"),{onSuccess:()=>{m.success("Admin account updated successfully"),r.reset(),x.value=!1,$.invalidateQueries({queryKey:["fetchAdmins"]})},onError:()=>{m.error("Email already exists"),console.error("Error")}})},w=q(!1);function I(_){A.id=_,w.value=!0}const A=C({id:""}),O=()=>{A.delete(route("delete.admin"),{onSuccess:()=>{m.success("Admin account deleted successfully"),A.reset(),w.value=!1,$.invalidateQueries({queryKey:["fetchAdmins"]})},onError:()=>{m.error("Deletion Error"),console.error("Error")}})};return(_,l)=>(g(),M(B,null,[s(e(Z),{title:"Admin Management"}),s(le,{breadcrumbs:L},{default:t(()=>[n("div",fe,[n("div",pe,[l[25]||(l[25]=n("h6",{class:"flex-1 text-md font-bold"},"Administrators",-1)),s(e(k),{open:v.value,"onUpdate:open":l[3]||(l[3]=a=>v.value=a)},{default:t(()=>[s(e(se),{"as-child":""},{default:t(()=>[s(e(f),{onClick:R,class:"cursor-pointer"},{default:t(()=>l[9]||(l[9]=[o(" + New ")])),_:1})]),_:1}),s(e(U),{class:"sm:max-w-[600px]"},{default:t(()=>[s(e(N),null,{default:t(()=>[s(e(S),null,{default:t(()=>l[10]||(l[10]=[o("Add Admin")])),_:1}),s(e(F),null,{default:t(()=>l[11]||(l[11]=[o(" Enter details for a new admin ")])),_:1})]),_:1}),n("form",{action:"",onSubmit:E(z,["prevent"])},[n("div",ce,[n("div",_e,[s(e(p),{class:"text-right"},{default:t(()=>l[12]||(l[12]=[o("Name")])),_:1}),s(e(c),{modelValue:e(d).name,"onUpdate:modelValue":l[0]||(l[0]=a=>e(d).name=a),placeholder:"John Doe",class:"col-span-3",required:""},null,8,["modelValue"])]),n("div",ge,[s(e(p),{class:"text-right"},{default:t(()=>l[13]||(l[13]=[o("Email")])),_:1}),s(e(c),{modelValue:e(d).email,"onUpdate:modelValue":l[1]||(l[1]=a=>e(d).email=a),type:"email",placeholder:"john@example.com",class:"col-span-3",required:""},null,8,["modelValue"])]),n("div",ye,[s(e(p),{class:"text-start"},{default:t(()=>l[14]||(l[14]=[o("Password")])),_:1}),s(e(c),{modelValue:e(d).password,"onUpdate:modelValue":l[2]||(l[2]=a=>e(d).password=a),placeholder:"Password",type:"password",class:"col-span-3",required:""},null,8,["modelValue"])])]),s(e(P),null,{default:t(()=>[s(e(f),{type:"submit",class:"cursor-pointer",disabled:e(d).processing},{default:t(()=>l[15]||(l[15]=[o("Save")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),s(e(k),{open:x.value,"onUpdate:open":l[7]||(l[7]=a=>x.value=a)},{default:t(()=>[s(e(U),{class:"sm:max-w-[600px]"},{default:t(()=>[s(e(N),null,{default:t(()=>[s(e(S),null,{default:t(()=>l[16]||(l[16]=[o("Edit Admin")])),_:1}),s(e(F),null,{default:t(()=>l[17]||(l[17]=[o(" Update details for the admin ")])),_:1})]),_:1}),n("form",{action:"",onSubmit:E(H,["prevent"])},[n("div",ve,[n("div",xe,[s(e(p),{class:"text-right"},{default:t(()=>l[18]||(l[18]=[o("Name")])),_:1}),s(e(c),{modelValue:e(r).name,"onUpdate:modelValue":l[4]||(l[4]=a=>e(r).name=a),placeholder:"John Doe",class:"col-span-3",required:""},null,8,["modelValue"])]),n("div",we,[s(e(p),{class:"text-right"},{default:t(()=>l[19]||(l[19]=[o("Email")])),_:1}),s(e(c),{modelValue:e(r).email,"onUpdate:modelValue":l[5]||(l[5]=a=>e(r).email=a),type:"email",placeholder:"john@example.com",class:"col-span-3",required:""},null,8,["modelValue"])]),n("div",Ae,[s(e(p),{class:"text-start"},{default:t(()=>l[20]||(l[20]=[o("Change Password")])),_:1}),s(e(c),{modelValue:e(r).password,"onUpdate:modelValue":l[6]||(l[6]=a=>e(r).password=a),placeholder:"Password",type:"password",class:"col-span-3"},null,8,["modelValue"])])]),s(e(P),null,{default:t(()=>[s(e(f),{type:"submit",class:"cursor-pointer",disabled:e(r).processing},{default:t(()=>l[21]||(l[21]=[o("Save")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),s(e(k),{open:w.value,"onUpdate:open":l[8]||(l[8]=a=>w.value=a)},{default:t(()=>[s(e(U),{class:"sm:max-w-[600px]"},{default:t(()=>[s(e(N),null,{default:t(()=>[s(e(S),null,{default:t(()=>l[22]||(l[22]=[o("Delete Admin")])),_:1}),s(e(F),null,{default:t(()=>l[23]||(l[23]=[o(" Are you sure you want to delete this admin? This action cannot be undone. ")])),_:1})]),_:1}),n("form",{action:"",onSubmit:E(O,["prevent"])},[s(e(P),null,{default:t(()=>[s(e(f),{type:"submit",class:"cursor-pointer",variant:"destructive",disabled:e(A).processing},{default:t(()=>l[24]||(l[24]=[o("Delete")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])]),s(e(te),null,{default:t(()=>[s(e(ae),null,{default:t(()=>[s(e(b),null,{default:t(()=>[s(e(y),{class:"w-[50px]"},{default:t(()=>l[26]||(l[26]=[n("small",null,"#",-1)])),_:1}),s(e(y),null,{default:t(()=>l[27]||(l[27]=[n("small",null,"Name",-1)])),_:1}),s(e(y),null,{default:t(()=>l[28]||(l[28]=[n("small",null,"Email",-1)])),_:1}),s(e(y),null,{default:t(()=>l[29]||(l[29]=[n("small",null,"Role",-1)])),_:1}),s(e(y),{class:"text-right"},{default:t(()=>l[30]||(l[30]=[n("small",null,"Actions",-1)])),_:1})]),_:1})]),_:1}),s(e(ne),null,{default:t(()=>{var a,K;return[e(J)?(g(),D(e(b),{key:0},{default:t(()=>[s(e(u),{colspan:"5",class:"text-center"},{default:t(()=>[n("small",Ve,[s(e(de),{class:"mr-2 w-5"}),l[31]||(l[31]=o(" Loading... "))])]),_:1})]),_:1})):Q("",!0),((a=e(j))==null?void 0:a.admins.length)==0?(g(),D(e(b),{key:1},{default:t(()=>[s(e(u),{colspan:"10"},{default:t(()=>[n("small",be,[s(e(ie),{class:"mr-2 w-5"}),l[32]||(l[32]=o(" No Data Found "))])]),_:1})]),_:1})):Q("",!0),(g(!0),M(B,null,h((K=e(j))==null?void 0:K.admins,(i,W)=>(g(),D(e(b),{key:i.encrypted_id},{default:t(()=>[s(e(u),null,{default:t(()=>[n("small",null,V(W+1),1)]),_:2},1024),s(e(u),null,{default:t(()=>[o(V(i.name),1)]),_:2},1024),s(e(u),null,{default:t(()=>[o(V(i.email),1)]),_:2},1024),s(e(u),null,{default:t(()=>[o(V(i.role==1?"Admin":""),1)]),_:2},1024),s(e(u),{class:"text-right"},{default:t(()=>[s(e(f),{variant:"link",class:"ml-2 cursor-pointer",onClick:X=>G(i.encrypted_id,i.name,i.email)},{default:t(()=>[s(e(ue))]),_:2},1032,["onClick"]),s(e(f),{variant:"destructive",onClick:X=>I(i.encrypted_id),class:"ml-2 cursor-pointer"},{default:t(()=>[s(e(me))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1})])]),_:1})],64))}});export{Be as default};

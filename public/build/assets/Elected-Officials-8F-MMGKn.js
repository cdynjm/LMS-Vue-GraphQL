import{d as ue,r as Q,C as L,c as B,o as v,a as l,u as e,m as fe,w as t,b as i,e as o,f as T,g as J,h,F as ee,i as me,t as C,j as pe}from"./app-BwfxnBRh.js";import{_ as ce,K as _}from"./AppLayout.vue_vue_type_script_setup_true_lang-DYfbvNJp.js";import{_ as W,a as ge,b as G,c as H,d as R,e as X,f as Y}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-D8UwES-R.js";import{_ as U,a as k,b as D,c as F,d as I,e as A,f}from"./SelectValue.vue_vue_type_script_setup_true_lang-C8eJmB40.js";import{_ as _e,a as ye,b as j,c as b,d as ve,e as y,C as xe,P as we,T as Ve}from"./TableHeader.vue_vue_type_script_setup_true_lang-CtTemYBy.js";import{_ as S}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CvooHbdp.js";import{_ as u,a as m}from"./Label.vue_vue_type_script_setup_true_lang-7CIRwA0j.js";import{u as be,a as Se}from"./useQuery-i8U5suod.js";import{L as $e}from"./loader-circle-DXr8m3Yh.js";import"./useForwardExpose-DSeBrvbd.js";import"./RovingFocusGroup-DWo2MZ64.js";import"./check-CYtqETVl.js";const qe={class:"p-6 space-y-6"},Ce={class:"flex w-full justify-between items-center"},Ee={class:"grid gap-4 py-4"},Oe={class:"grid grid-cols-4 items-center gap-4"},Pe={class:"grid grid-cols-4 items-center gap-4"},Me={class:"grid grid-cols-4 items-center gap-4"},Be={class:"grid grid-cols-4 items-center gap-4"},Ue={class:"grid grid-cols-4 items-center gap-4"},ke={class:"grid grid-cols-4 items-center gap-4"},De={class:"grid grid-cols-4 items-center gap-4"},Fe={class:"grid gap-4 py-4"},Ie={class:"grid grid-cols-4 items-center gap-4"},Ae={class:"grid grid-cols-4 items-center gap-4"},je={class:"grid grid-cols-4 items-center gap-4"},Ne={class:"grid grid-cols-4 items-center gap-4"},ze={class:"grid grid-cols-4 items-center gap-4"},Ke={class:"grid grid-cols-4 items-center gap-4"},Qe={class:"grid grid-cols-4 items-center gap-4"},Le={class:"text-center text-green-500 flex items-center justify-center"},Te={class:"text-center text-red-500 flex items-center justify-center"},Je={class:"flex items-center space-x-3"},We=["src"],Ge={class:"font-medium"},He={class:"text-gray-500"},Re={key:0,class:"text-green-500"},Xe={key:1,class:"text-red-500"},se=async(N,{quality:$=.3,type:z="image/jpeg"})=>{const q=await createImageBitmap(N),x=document.createElement("canvas");x.width=q.width,x.height=q.height;const K=x.getContext("2d");if(!K)throw new Error("Could not get canvas context");K.drawImage(q,0,0);const w=await new Promise(Z=>x.toBlob(Z,z,$));if(!w)throw new Error("Image compression failed: blob is null");return new File([w],N.name,{type:w.type})},ns=ue({__name:"Elected-Officials",setup(N){const $=be(),z=[{title:"Elected Officials",href:"/admin/elected-officials"}],q=async()=>(await pe.post("/graphql",{query:`
    query {
      officials {
        encrypted_id
        name
        address
        position
        status
        photo
        user {
           email
        }
      }
    }
  `})).data.data,{isPending:x,error:K,data:w,isFetching:Z}=Se({queryKey:["fetchOfficials"],queryFn:q}),E=Q(!1);function le(){E.value=!0}const n=L({name:"",address:"",position:"",status:"",email:"",password:"",picture:null}),te=()=>{n.post(route("create.official"),{onSuccess:()=>{_.success("Official created successfully"),n.reset(),E.value=!1,$.invalidateQueries({queryKey:["fetchOfficials"]})},onError:()=>{_.error("Email already exists"),console.error("Error")}})},O=Q(!1);function ae(p,s,a,V,d,c){r.id=p,r.name=s,r.address=a,r.position=V,r.status=d,r.email=c,O.value=!0}const r=L({id:"",name:"",address:"",position:"",status:"",email:"",password:"",picture:null}),oe=()=>{r.post(route("update.official"),{onSuccess:()=>{_.success("Official updated successfully"),r.reset(),O.value=!1,$.invalidateQueries({queryKey:["fetchOfficials"]})},onError:()=>{_.error("Email already exists"),console.error("Error")}})},P=Q(!1);function ie(p){M.id=p,P.value=!0}const M=L({id:""}),re=()=>{M.delete(route("delete.official"),{onSuccess:()=>{_.success("Official deleted successfully"),M.reset(),P.value=!1,$.invalidateQueries({queryKey:["fetchOfficials"]})},onError:()=>{_.error("Deletion Error"),console.error("Error")}})},de=async p=>{var c;const s=p.target,a=(c=s.files)==null?void 0:c[0];if(!a)return;const d=2*1024*1024;if(a.type.startsWith("image"))try{a.size>d&&(s.value="",_.error("File too large. Please select a smaller file."));const g=await se(a,{quality:.3,type:a.type});n.picture=g}catch(g){console.error("Compression error:",g)}},ne=async p=>{var c;const s=p.target,a=(c=s.files)==null?void 0:c[0];if(!a)return;const d=2*1024*1024;if(a.type.startsWith("image"))try{a.size>d&&(s.value="",_.error("File too large. Please select a smaller file."));const g=await se(a,{quality:.3,type:a.type});r.picture=g}catch(g){console.error("Compression error:",g)}};return(p,s)=>(v(),B(ee,null,[l(e(fe),{title:"Elected Officials"}),l(ce,{breadcrumbs:z},{default:t(()=>[i("div",qe,[i("div",Ce,[s[53]||(s[53]=i("h6",{class:"flex-1 text-md font-bold"},"Elected Officials",-1)),l(e(W),{open:E.value,"onUpdate:open":s[6]||(s[6]=a=>E.value=a)},{default:t(()=>[l(e(ge),{"as-child":""},{default:t(()=>[l(e(S),{onClick:le,class:"cursor-pointer"},{default:t(()=>s[15]||(s[15]=[o(" + New ")])),_:1})]),_:1}),l(e(G),{class:"sm:max-w-[600px]"},{default:t(()=>[l(e(H),null,{default:t(()=>[l(e(R),null,{default:t(()=>s[16]||(s[16]=[o("Add Official")])),_:1}),l(e(X),null,{default:t(()=>s[17]||(s[17]=[o(" Enter details for a new official ")])),_:1})]),_:1}),i("form",{action:"",onSubmit:T(te,["prevent"])},[i("div",Ee,[i("div",Oe,[l(e(u),{class:"text-right"},{default:t(()=>s[18]||(s[18]=[o("Name")])),_:1}),l(e(m),{modelValue:e(n).name,"onUpdate:modelValue":s[0]||(s[0]=a=>e(n).name=a),placeholder:"John Doe",class:"col-span-3",required:""},null,8,["modelValue"])]),i("div",Pe,[l(e(u),{class:"text-right"},{default:t(()=>s[19]||(s[19]=[o("Address")])),_:1}),l(e(m),{modelValue:e(n).address,"onUpdate:modelValue":s[1]||(s[1]=a=>e(n).address=a),placeholder:"Address",class:"col-span-3",required:""},null,8,["modelValue"])]),i("div",Me,[l(e(u),{class:"text-right"},{default:t(()=>s[20]||(s[20]=[o("Position")])),_:1}),l(e(U),{modelValue:e(n).position,"onUpdate:modelValue":s[2]||(s[2]=a=>e(n).position=a),class:"col-span-3",required:""},{default:t(()=>[l(e(k),{class:"w-[180px]"},{default:t(()=>[l(e(D),{placeholder:"Select a position"})]),_:1}),l(e(F),null,{default:t(()=>[l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>s[21]||(s[21]=[o("Positions")])),_:1}),l(e(f),{value:"Mayor"},{default:t(()=>s[22]||(s[22]=[o(" Mayor ")])),_:1}),l(e(f),{value:"Vice Mayor"},{default:t(()=>s[23]||(s[23]=[o(" Vice Mayor ")])),_:1}),l(e(f),{value:"SB Member"},{default:t(()=>s[24]||(s[24]=[o(" SB Member ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",Be,[l(e(u),{class:"text-right"},{default:t(()=>s[25]||(s[25]=[o("Status")])),_:1}),l(e(U),{modelValue:e(n).status,"onUpdate:modelValue":s[3]||(s[3]=a=>e(n).status=a),class:"col-span-3",required:""},{default:t(()=>[l(e(k),{class:"w-[180px]"},{default:t(()=>[l(e(D),{placeholder:"Select a status"})]),_:1}),l(e(F),null,{default:t(()=>[l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>s[26]||(s[26]=[o("Status")])),_:1}),l(e(f),{value:"1"},{default:t(()=>s[27]||(s[27]=[o(" Active ")])),_:1}),l(e(f),{value:"2"},{default:t(()=>s[28]||(s[28]=[o(" Inactive ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",Ue,[l(e(u),{class:"text-right"},{default:t(()=>s[29]||(s[29]=[o("Picture")])),_:1}),l(e(m),{type:"file",class:"col-span-3",onChange:de,accept:"image/*",required:""})]),i("div",ke,[l(e(u),{class:"text-right"},{default:t(()=>s[30]||(s[30]=[o("Email")])),_:1}),l(e(m),{modelValue:e(n).email,"onUpdate:modelValue":s[4]||(s[4]=a=>e(n).email=a),type:"email",placeholder:"john@example.com",class:"col-span-3",required:""},null,8,["modelValue"])]),i("div",De,[l(e(u),{class:"text-start"},{default:t(()=>s[31]||(s[31]=[o("Password")])),_:1}),l(e(m),{modelValue:e(n).password,"onUpdate:modelValue":s[5]||(s[5]=a=>e(n).password=a),placeholder:"Password",type:"password",class:"col-span-3",required:""},null,8,["modelValue"])])]),l(e(Y),null,{default:t(()=>[l(e(S),{type:"submit",class:"cursor-pointer",disabled:e(n).processing},{default:t(()=>s[32]||(s[32]=[o("Save")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),l(e(W),{open:O.value,"onUpdate:open":s[13]||(s[13]=a=>O.value=a)},{default:t(()=>[l(e(G),{class:"sm:max-w-[600px]"},{default:t(()=>[l(e(H),null,{default:t(()=>[l(e(R),null,{default:t(()=>s[33]||(s[33]=[o("Edit Official")])),_:1}),l(e(X),null,{default:t(()=>s[34]||(s[34]=[o(" Update the details of the official ")])),_:1})]),_:1}),i("form",{action:"",onSubmit:T(oe,["prevent"])},[i("div",Fe,[i("div",Ie,[l(e(u),{class:"text-right"},{default:t(()=>s[35]||(s[35]=[o("Name")])),_:1}),l(e(m),{modelValue:e(r).name,"onUpdate:modelValue":s[7]||(s[7]=a=>e(r).name=a),placeholder:"John Doe",class:"col-span-3",required:""},null,8,["modelValue"])]),i("div",Ae,[l(e(u),{class:"text-right"},{default:t(()=>s[36]||(s[36]=[o("Address")])),_:1}),l(e(m),{modelValue:e(r).address,"onUpdate:modelValue":s[8]||(s[8]=a=>e(r).address=a),placeholder:"Address",class:"col-span-3",required:""},null,8,["modelValue"])]),i("div",je,[l(e(u),{class:"text-right"},{default:t(()=>s[37]||(s[37]=[o("Position")])),_:1}),l(e(U),{modelValue:e(r).position,"onUpdate:modelValue":s[9]||(s[9]=a=>e(r).position=a),class:"col-span-3",required:""},{default:t(()=>[l(e(k),{class:"w-[180px]"},{default:t(()=>[l(e(D),{placeholder:"Select a position"})]),_:1}),l(e(F),null,{default:t(()=>[l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>s[38]||(s[38]=[o("Positions")])),_:1}),l(e(f),{value:"Mayor"},{default:t(()=>s[39]||(s[39]=[o(" Mayor ")])),_:1}),l(e(f),{value:"Vice Mayor"},{default:t(()=>s[40]||(s[40]=[o(" Vice Mayor ")])),_:1}),l(e(f),{value:"SB Member"},{default:t(()=>s[41]||(s[41]=[o(" SB Member ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",Ne,[l(e(u),{class:"text-right"},{default:t(()=>s[42]||(s[42]=[o("Status")])),_:1}),l(e(U),{modelValue:e(r).status,"onUpdate:modelValue":s[10]||(s[10]=a=>e(r).status=a),class:"col-span-3",required:""},{default:t(()=>[l(e(k),{class:"w-[180px]"},{default:t(()=>[l(e(D),{placeholder:"Select a status"})]),_:1}),l(e(F),null,{default:t(()=>[l(e(I),null,{default:t(()=>[l(e(A),null,{default:t(()=>s[43]||(s[43]=[o("Status")])),_:1}),l(e(f),{value:"1"},{default:t(()=>s[44]||(s[44]=[o(" Active ")])),_:1}),l(e(f),{value:"2"},{default:t(()=>s[45]||(s[45]=[o(" Inactive ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",ze,[l(e(u),{class:"text-left"},{default:t(()=>s[46]||(s[46]=[o("Change Picture")])),_:1}),l(e(m),{type:"file",class:"col-span-3",onChange:ne,accept:"image/*"})]),i("div",Ke,[l(e(u),{class:"text-right"},{default:t(()=>s[47]||(s[47]=[o("Email")])),_:1}),l(e(m),{modelValue:e(r).email,"onUpdate:modelValue":s[11]||(s[11]=a=>e(r).email=a),type:"email",placeholder:"john@example.com",class:"col-span-3",required:""},null,8,["modelValue"])]),i("div",Qe,[l(e(u),{class:"text-start"},{default:t(()=>s[48]||(s[48]=[o("Change Password")])),_:1}),l(e(m),{modelValue:e(r).password,"onUpdate:modelValue":s[12]||(s[12]=a=>e(r).password=a),placeholder:"Password",type:"password",class:"col-span-3"},null,8,["modelValue"])])]),l(e(Y),null,{default:t(()=>[l(e(S),{type:"submit",class:"cursor-pointer",disabled:e(r).processing},{default:t(()=>s[49]||(s[49]=[o("Save")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]),l(e(W),{open:P.value,"onUpdate:open":s[14]||(s[14]=a=>P.value=a)},{default:t(()=>[l(e(G),{class:"sm:max-w-[600px]"},{default:t(()=>[l(e(H),null,{default:t(()=>[l(e(R),null,{default:t(()=>s[50]||(s[50]=[o("Delete Official")])),_:1}),l(e(X),null,{default:t(()=>s[51]||(s[51]=[o(" Are you sure you want to delete this official? This action cannot be undone. ")])),_:1})]),_:1}),i("form",{action:"",onSubmit:T(re,["prevent"])},[l(e(Y),null,{default:t(()=>[l(e(S),{type:"submit",class:"cursor-pointer",variant:"destructive",disabled:e(M).processing},{default:t(()=>s[52]||(s[52]=[o("Delete")])),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])]),l(e(_e),null,{default:t(()=>[l(e(ye),null,{default:t(()=>[l(e(j),null,{default:t(()=>[l(e(b),{class:"w-[50px]"},{default:t(()=>s[54]||(s[54]=[i("small",null,"#",-1)])),_:1}),l(e(b),{class:"w-[300px]"},{default:t(()=>s[55]||(s[55]=[i("small",null,"Name",-1)])),_:1}),l(e(b),null,{default:t(()=>s[56]||(s[56]=[i("small",null,"Position",-1)])),_:1}),l(e(b),null,{default:t(()=>s[57]||(s[57]=[i("small",null,"Address",-1)])),_:1}),l(e(b),{class:"text-right"},{default:t(()=>s[58]||(s[58]=[i("small",null,"Status",-1)])),_:1}),l(e(b),{class:"text-right"},{default:t(()=>s[59]||(s[59]=[i("small",null,"Actions",-1)])),_:1})]),_:1})]),_:1}),l(e(ve),null,{default:t(()=>{var a,V;return[e(x)?(v(),J(e(j),{key:0},{default:t(()=>[l(e(y),{colspan:"10",class:"text-center"},{default:t(()=>[i("small",Le,[l(e($e),{class:"mr-2 w-5"}),s[60]||(s[60]=o(" Loading... "))])]),_:1})]),_:1})):h("",!0),((a=e(w))==null?void 0:a.officials.length)==0?(v(),J(e(j),{key:1},{default:t(()=>[l(e(y),{colspan:"5"},{default:t(()=>[i("small",Te,[l(e(xe),{class:"mr-2 w-5"}),s[61]||(s[61]=o(" No Data Found "))])]),_:1})]),_:1})):h("",!0),(v(!0),B(ee,null,me((V=e(w))==null?void 0:V.officials,(d,c)=>(v(),J(e(j),{key:d.id},{default:t(()=>[l(e(y),null,{default:t(()=>[i("small",null,C(c+1),1)]),_:2},1024),l(e(y),{class:"w-[300px] pr-20"},{default:t(()=>[i("div",Je,[i("img",{src:"/storage/profile/"+d.photo,alt:"Profile",class:"w-10 h-10 rounded-full object-cover"},null,8,We),i("div",null,[i("div",Ge,C(d.name),1),i("small",He,C(d.user.email),1)])])]),_:2},1024),l(e(y),null,{default:t(()=>[o(C(d.position),1)]),_:2},1024),l(e(y),null,{default:t(()=>[o(C(d.address),1)]),_:2},1024),l(e(y),{class:"text-right"},{default:t(()=>[d.status==1?(v(),B("span",Re,"Active")):(v(),B("span",Xe,"Inactive"))]),_:2},1024),l(e(y),{class:"text-right"},{default:t(()=>[l(e(S),{variant:"link",onClick:g=>ae(d.encrypted_id,d.name,d.address,d.position,d.status,d.user.email),class:"ml-2 cursor-pointer"},{default:t(()=>[l(e(we))]),_:2},1032,["onClick"]),l(e(S),{variant:"destructive",onClick:g=>ie(d.encrypted_id),class:"ml-2 cursor-pointer"},{default:t(()=>[l(e(Ve))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1})])]),_:1})],64))}});export{ns as default};
